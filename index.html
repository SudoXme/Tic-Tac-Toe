<!DOCTYPE html>
<html>
  <head>
    <title>Tic Tac Toe</title>
    <link rel="icon" href="./Tic Tac Toe icon.png">
  </head>
  <body style="font-family: system-ui; background-color: #0f172a;">
    <h1 style="display: flex; color: #38bdf8; align-items: center; justify-content: center; font-size: 60px">Tic Tac Toe</h1>

    <div class="grid" style="display: flex; align-items: center; justify-content: space-between; align-items: center;">

      <div class="left-panel" style="display: flex; margin-left: 80px;">

        <div class="active" style="font-size: 70px; color: #f43f5e; ">></div>

        <div class="player-details" style="width: 250px;">
          <div class="player-1" style="display: flex; align-items: center; justify-content: space-between; margin-top: 8px;">
            <div class="player-name-1" style="font-size: 30px; color: #e5e7eb;">Player-1</div>
            <div class="X" style="font-size: 70px; color: #38bdf8; margin-right: 6px;">X</div>
          </div>
          <div class="player-2" style="display: flex; align-items: center; justify-content: space-between;">
            <div class="player-name-2" style="font-size: 30px; color: #94a3b8;">Player-2</div>
            <div class="O" style="font-size: 70px; color: #f43f5e;">O</div>
          </div>
        </div>

      </div>

      <div class="mid-panel" style="display: flex; margin-left: 100px;">
        <div class="first-col" style="display: inline-block; align-items: center; justify-content: center; background-color: #22d3ee; margin: 0px;">

          <div class="cell-1" style="background-color: #1e293b; height: 120px; width: 120px; margin-bottom: 4px; margin-right: 4px; font-size: 20px; border: 2px solid #475569; cursor: pointer;" onmouseenter="this.style.background='#334155'" onmouseleave="this.style.background='#1e293b'  " onclick=cellClicked() onmousedown="clickedCellNumber = '1'">
            <div class="X" style="font-size: 90px; margin-left: 35px; color: #38bdf8;">X</div>
          </div>

          <div class="cell-2" style="background-color: #1e293b; height: 120px; width: 120px; margin-bottom: 4px; margin-right: 4px; border: 2px solid #475569; cursor: pointer;" onmouseenter="this.style.background='#334155'" onmouseleave="this.style.background='#1e293b'" onclick=cellClicked() onmousedown="clickedCellNumber = '2'">
            <div class="O" style="font-size: 90px; margin-left: 25px; color: #f43f5e;">O</div>
          </div>

          <div class="cell-3" style="background-color: #1e293b; height: 120px; width: 120px; margin-right: 4px; border: 2px solid #475569; cursor: pointer;" onmouseenter="this.style.background='#334155'" onmouseleave="this.style.background='#1e293b'" onclick=cellClicked() onmousedown="clickedCellNumber = '3'"></div>
        </div>

        <div class="second-col" style="display: inline-block; align-items: center; justify-content: center; background-color: #22d3ee; margin: 0px;">
          <div class="cell-4" style="background-color: #1e293b; height: 120px; width: 120px; margin-bottom: 4px; margin-right: 4px; border: 2px solid #475569; cursor: pointer;" onmouseenter="this.style.background='#334155'" onmouseleave="this.style.background='#1e293b'" onclick=cellClicked() onmousedown="clickedCellNumber = '4'"></div>
          <div class="cell-5" style="background-color: #1e293b; height: 120px; width: 120px; margin-bottom: 4px; margin-right: 4px; border: 2px solid #475569; cursor: pointer;" onmouseenter="this.style.background='#334155'" onmouseleave="this.style.background='#1e293b'" onclick=cellClicked() onmousedown="clickedCellNumber = '5'"></div>
          <div class="cell-6" style="background-color: #1e293b; height: 120px; width: 120px; margin-right: 4px; border: 2px solid #475569; cursor: pointer;" onmouseenter="this.style.background='#334155'" onmouseleave="this.style.background='#1e293b'" onclick=cellClicked() onmousedown="clickedCellNumber = '6'">
            <div class="X" style="font-size: 90px; margin-left: 35px; color: #38bdf8;">X</div>
          </div>
        </div>

        <div class="third-col" style="display: inline-block; align-items: center; justify-content: center; background-color: #22d3ee; margin: 0px;">
          <div class="cell-7" style="background-color: #1e293b; height: 120px; width: 120px; margin-bottom: 4px; border: 2px solid #475569; cursor: pointer;" onmouseenter="this.style.background='#334155'" onmouseleave="this.style.background='#1e293b'" onclick=cellClicked() onmousedown="clickedCellNumber = '7'">
            <div class="O" style="font-size: 90px; margin-left: 25px; color: #f43f5e;">O</div>
          </div>
          <div class="cell-8" style="background-color: #1e293b; height: 120px; width: 120px; margin-bottom: 4px; border: 2px solid #475569; cursor: pointer;" onmouseenter="this.style.background='#334155'" onmouseleave="this.style.background='#1e293b'" onclick=cellClicked() onmousedown="clickedCellNumber = '8'"></div>
          <div class="cell-9" style="background-color: #1e293b; height: 120px; width: 120px; border: 2px solid #475569; cursor: pointer;" onmouseenter="this.style.background='#334155'" onmouseleave="this.style.background='#1e293b'" onclick=cellClicked() onmousedown="clickedCellNumber = '9'"></div>
        </div>

      </div>

      <div class="right-panel" style="display: flex; flex-direction: column; margin-right: 10px;">
        <h1 class="timer" style="display: flex; align-items: center; justify-content: center; font-weight: bold; color: #e5e7eb; font-size: 40px;"></h1>
        <div class="row-1" style="display: block; margin: 0px;">
          <h1 class="subtitle" style="font-size: 50px; color: #e5e7eb; margin-top: 0px;">Welcome to the game</h1>
          <div class="game-start" style="display: flex; justify-content: space-between; align-items: center;">
            <p1 style="font-size: 40px; color: #38bdf8; font-weight: bold; margin-bottom: 8px;">Start a new game</p1>

            <button class="start-button" style="background-color: #3b82f6; color: white; font-weight: bold; border: 2px solid black; font-size: 20px; padding: 12px; border-radius: 10px; cursor: pointer;" onmouseenter="this.style.background='#2563eb'" onmouseleave="this.style.background='#3b82f6'" onmousedown="this.style.background='#3b82f6'" onmouseup="this.style.background='#2563eb'" onclick=startGame()>New Game</button>

          </div>
        </div>

        <div class="result" style="display: flex; align-items: center; justify-content: center; color: #e5e7eb; font-size: 40px; font-weight: bold; margin-top: 20px;">
        </div>
      </div

    </div>
    <script>
      const pointer = document.getElementsByClassName("active")[0];
      const player1 = document.getElementsByClassName("player-name-1")[0];
      const player2 = document.getElementsByClassName("player-name-2")[0];
      const resultOrInfo = document.getElementsByClassName("result")[0];
      const timer = document.getElementsByClassName("timer")[0];
      const activePlayerColor = "rgb(229, 231, 235)"
      const X = `<div class="X" style="font-size: 90px; margin-left: 35px; color: #38bdf8;">X</div>`;
      const O = `<div class="O" style="font-size: 90px; margin-left: 25px; color: #f43f5e;">O</div>`;
      let clickedCellNumber = '';
      let gameStarted = false;
      let gameDraw = false;
      let cells = ["","","","","","","","",""];
      let isGameFinished = false;

      const startGame = () => {
        gameStarted = true;
        isGameFinished = false;
        resultOrInfo.innerHTML = "New game started, X's turn"
        let i = 1;
        cells.map( (c) => {
          document.getElementsByClassName(`cell-${i}`)[0].innerHTML = "";
          i++;
        })
        cells = ["","","","","","","","",""];


        pointer.style.marginTop = "0px";
        player2.style.color = "#94a3b8";
        player1.style.color = "#e5e7eb";
      }

      // Write the code for the timer that will be shown when the game is somebody won/lost or the game is draw. 
      const startTimer = () => {
        let t = 5;
        let j = 0;
        while(j<5){
          setTimeout(() => {
            timer.innerText = `Starting new game in ${t--}s`;
          }, j*1000);
          j++;
        }

        setTimeout(() => {
          timer.innerText = "";
          startGame();
        }, t*1000);
      }

      const setActivePlayer = () => {

        if(player1.style.color === activePlayerColor){
          pointer.style.marginTop = "95px";
          player1.style.color = "#94a3b8";
          player2.style.color = "#e5e7eb";
        }else{
          pointer.style.marginTop = "0px";
          player2.style.color = "#94a3b8";
          player1.style.color = "#e5e7eb";
        }

      }


      // Write the code to check whether someone won/lost or the game is draw
      const winArrangements = [
        [1, 2, 3],
        [1, 4, 7],
        [1, 5, 9],
        [2, 5, 8],
        [3, 6, 9],
        [3, 5, 7],
        [4, 5, 6],
        [7, 8, 9],
      ]

      // If X or O are present at cells[0], cells[1], cells[2] then either X or O win's. 
      // 0 = winArrangements[0][0] - 1, 1 = winArrangements[0][1] - 1, 2 = winArrangements[0][2] - 1
      // So if cells[0] = cells[1] = cells[2], then either X or O win's;
      //console.log(winArrangements[0][0])

      // Iterate over the cells array and check if any cell is empty. 
      // If there is no empty cells then declare the game draw
      // Now write the code to check who has won (X or O);



      const gameResult = () => {
        let gResult = "";


        isEmptyCellPresent = cells.includes("");

        if(!isEmptyCellPresent){
          gResult = "Draw ðŸ¤";
          startTimer();
          isGameFinished = true;
        }

        winArrangements.map((a) => {
          if(cells[a[0]-1] === cells[a[1]-1] && cells[a[1]-1] === cells[a[2]-1] && cells[a[0]-1] != ""){
            player1.style.color === activePlayerColor ? gResult = "O Won âœ¨" : gResult = "X Won âœ¨";
            startTimer();
            isGameFinished = true;
          }
        })
      
        resultOrInfo.innerText = gResult;
      }


      // Before it write the code to fill the entries (X or O) in the cells array;

      const fillCellArray = (cellEntry) => {
        cells[clickedCellNumber-1] = cellEntry;
      }

      // Write the code so that If somebody has won or the game is draw the cells can't be clikced.
      
      const cellClicked = () => {
        let clickedCell = document.getElementsByClassName(`cell-${clickedCellNumber}`)[0];
        let isCellEmpty = clickedCell.innerHTML === "";


        if(!gameStarted){

          setTimeout(() => {
            resultOrInfo.innerHTML= "";
          }, 2000);
          resultOrInfo.innerText = "Plz start a new game";
          return;
        }

        if(isGameFinished){
          return; 
        }

        if(!isCellEmpty){

          setTimeout(() => {
            resultOrInfo.innerHTML= "";
          }, 2000);
          resultOrInfo.innerText = "Cell is occupied"
          return;
        }


        if(player1.style.color === activePlayerColor){
          clickedCell.innerHTML = X;
          fillCellArray("X");
        }else{
          clickedCell.innerHTML = O;
          fillCellArray("O");
        }
        setActivePlayer();
        resultOrInfo.innerText ="";
        gameResult();

        /**

        if(gameStarted){
          let clickedCell = document.getElementsByClassName(`cell-${clickedCellNumber}`)[0];

          let isCellEmpty = clickedCell.innerHTML === "";
          if(isCellEmpty){
            if(player1.style.color === activePlayerColor){
              clickedCell.innerHTML = X;
              fillCellArray("X");
            }else{
              clickedCell.innerHTML = O;
              fillCellArray("O");
            }
            setActivePlayer();
            resultOrInfo.innerText ="";
            gameResult();
          }else{
            setTimeout(() => {
              resultOrInfo.innerHTML= "";
            }, 2000);
            resultOrInfo.innerText = "Cell is occupied"
          }
        }else{
          setTimeout(() => {
            resultOrInfo.innerHTML= "";
          }, 2000);
          resultOrInfo.innerText = "Plz start a new game"
        }
      }
        **/

      }

    </script>

  </body>
</html>
